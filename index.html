<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SourceRE API Documentation</title>
    <style>
      header nav {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        height: 100%;
      }

      header nav span {
        position: relative;
        cursor: pointer;
        padding: 6px 16px;
        font-size: 14px;
        font-weight: 500;
        color: #555;
        transition: color 0.2s ease;
        border-radius: 6px;
      }

      header nav span:hover {
        background-color: #f0f0f0;
      }

      header nav span.active {
        color: #6307a6;
        font-weight: 600;
      }

      header nav span.active::after {
        content: "";
        position: absolute;
        bottom: -6px;
        left: 0;
        right: 0;
        height: 3px;
        background-color: #6307a6;
        border-radius: 2px;
      }

      .section-nav {
        position: fixed;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: flex-start;
        top: 0;
        left: 0;
        width: 240px;
        height: 100vh;
        background: #ffffff;
        padding: 0;
        margin: 0;
        border-right: 1px solid #eee;
        box-shadow: none;
        z-index: 100;
        overflow-y: auto;
      }

      /* this is showing up too low */
      .section-nav nav {
        background: #ffffff;
        width: 240px;
        height: 100%;
        list-style: none;
        padding: 0 !important;
        margin: 0 !important;
      }

      .section-nav nav ul {
        width: 240px;
        list-style: none;
        padding: 0 !important;
        margin: 0 !important;
      }

      html {
        scroll-padding-top: 60px;
        scroll-behavior: smooth;
      }

      .section-nav nav ul li {
        width: 240px;
        margin: 0 !important;
        padding: 0 !important;
      }

      .section-nav nav ul li a {
        display: block;
        padding: 16px 20px;
        color: #000000;
        font-size: 15px;
        font-weight: 500;
        text-decoration: none;
        background: #ffffff;
        border-top: 1px solid #f0f0f0;
      }

      .section-nav nav ul li:first-child a {
        border-top: none;
      }

      .section-nav nav ul li a:hover {
        background-color: #f7f7f7;
      }

      .section-nav nav ul li a.active {
        background-color: #f0f0f0;
        font-weight: 600;
      }

      body {
        margin-left: 240px;
      }

      code {
        background: #f5f4f4;
        color: #000000;
        font-weight: 500;
        padding: 2px 3px;
        border-radius: 4px;
        font-size: 16px;
        font-family: Arial, Helvetica, sans-serif;
      }
      .code-block {
        background: #000030;
        color: #ffffff;
        padding: 10px 20px;
        border-radius: 4px;
        font-family: monospace;
        font-size: 14px;
        line-height: 1.5;
        margin-bottom: 1rem;
        margin-top: 0rem;
        display: block;
      }
      a {
        color: #6307a6;
        text-decoration: none;
      }
      body {
        margin: 0;
        font-family: sans-serif;
        background: #ffffff;
        line-height: 1.7;
        color: #333;
      }
      header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: #fff;
        color: #1a202c;
        padding: 0.9rem 2rem;
        position: sticky;
        top: 0;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        z-index: 1000;
      }

      header img {
        height: 32px;
        margin-right: 0.5rem;
      }
      header .title {
        display: flex;
        align-items: center;
        font-weight: 600;
        font-size: 1.2rem;
      }
      main {
        padding: 2rem;
        max-width: 1000px;
        margin: auto;
        background: #ffffff;
      }
      .tab-content {
        display: none;
      }
      .tab-content.active {
        display: block;
      }
      h1,
      h2,
      h3 {
        font-weight: 500;
        margin-top: 1rem;
        padding-top: 1rem;
        border-top: 1px solid #eee;
      }
      h1:first-child,
      h2:first-child,
      h3:first-child {
        border-top: none;
        padding-top: 0;
      }
      h4 {
        font-size: 16px;
        font-weight: 600;
        margin-top: 1rem;
        padding-top: 1rem;
        border-top: 1px solid #eee;
      }
      pre {
        background: #f5f5f5;
        padding: 1rem;
        overflow: auto;
        border-radius: 6px;
      }
      table {
        border-collapse: collapse;
        width: 100%;
        margin-top: 1rem;
        margin-bottom: 1rem;
      }
      table,
      th,
      td {
        border: 1px solid #ddd;
      }
      th,
      td {
        padding: 8px 12px;
        text-align: left;
      }
      main ul,
      main ol {
        padding-left: 1.5rem;
        margin-top: 0.5rem;
        margin-bottom: 1.5rem;
      }
      p {
        /* margin-top: 1rem;
        margin-bottom: 1rem; */
      }
    </style>
  </head>
  <body>
    <header>
      <div class="title">
        <img src="logo.png" alt="SourceRE Logo" />
        API DOCUMENTATION
      </div>
      <nav>
        <span data-tab="webapi" class="active">RESO Web API</span>
        <span data-tab="addedit">Add/Edit API</span>
      </nav>
    </header>
    <div id="webapi" class="tab-content active">
      <aside
        id="section-nav-webapi"
        class="section-nav"
        style="
          position: fixed;
          top: 50px;
          left: 0;
          width: 200px;
          padding: 1rem;
          background: #f9f9f9;
          border-right: 1px solid #ddd;
          height: calc(100% - 60px);
          overflow-y: auto;
        "
      >
        <nav>
          <ul
            id="section-list-webapi"
            style="list-style: none; padding: 0; margin: 0"
          >
            <!-- dynamically populated -->
          </ul>
        </nav>
      </aside>
      <div style="margin-left: 240px">
        <main class="webapi-main">
          <div>
            <h1>SourceRE RESO Web API</h1>

            <h2 id="webapi-overview">Overview</h2>
            <p>
              SourceRE is a platform designed for real estate software vendors
              to access standardized data feeds. It enables vendors to purchase
              access to MLS data based on Plans defined by the MLS, which are
              provisioned for the vendor's specific Products. When a vendor
              purchases a Plan for one of their Products, they receive an API
              feed. Feeds are accessed via feed-specific JWT bearer tokens. Each
              token is active for 1 year, and a new token can be retrieved at
              any time by pressing "Copy Bearer Token" on the feed within the
              Data Marketplace.
            </p>
            <p>
              Data access, structure, and enumerations are tailored per Plan.
              Every Feed reflects its Plan's specific metadata, field-level
              permissions, and record-level access rules, ensuring the MLS
              retains granular control over how its data is consumed.
            </p>
            <p>
              MLS Data is available via the SourceRE RESO Web API, and it is
              standardized according to the RESO Data Dictionary. For more
              information about the RESO Web API specification, please visit the
              <a href="https://www.reso.org/reso-web-api/" target="_blank"
                >RESO Website</a
              >. A guide to authenicating, querying, and replicating data from
              the SourceRE RESO Web API is provided below.
            </p>

            <h2 id="webapi-authentication">Authentication</h2>
            <p>
              The JWT bearer token must be included in the
              <code>Authorization</code> header for all API requests.
            </p>
            <div class="code-block">
              Authorization: Bearer &lt;your_token&gt;
            </div>
            <p>
              These tokens are long-lived and should be stored securely. Tokens
              are scoped to a specific Feed and can only access data from that
              feed.
            </p>

            <h2 id="webapi-metadata-lookups">Metadata & Lookups</h2>
            <p>
              SourceRE provides metadata discovery in accordance with the RESO
              Web API standard:
            </p>
            <h4 id="webapi-service-endpoint">Service Endpoint</h4>
            <div class="code-block">GET https://api.sourceredb.com/odata/</div>
            <p>
              Describes the available entity types (resources) for the given
              feed.
            </p>
            <h4>Metadata Endpoint</h4>
            <div class="code-block">
              GET https://api.sourceredb.com/odata/$metadata
            </div>
            <p>
              Describes the available fields for each entity type, including
              navigation properties.
            </p>
            <p>
              Enumeration fields in the metadata are typed as
              <code>Edm.String</code> or <code>Collection(Edm.String)</code> and
              include a <code>RESO.OData.Metadata.LookupName</code> annotation
              identifying the Lookup name. For example, the
              <code>PropertyType</code> field has the following annotation:
            </p>
            <div class="code-block">
              &lt;Annotation Term="RESO.OData.Metadata.LookupName"
              String="PropertyType" /&gt;
            </div>
            <h4>Lookup Endpoint</h4>
            <div class="code-block">
              GET https://api.sourceredb.com/odata/Lookup?$filter=LookupName eq
              'PropertyType'
            </div>
            <p>
              Returns enumeration values for fields annotated with
              <code>RESO.OData.Metadata.LookupName</code>, according to the RESO
              Web API specification.
            </p>

            <h2 id="webapi-data-access-structure">Data Access and Structure</h2>
            <h3>Endpoints</h3>
            <p>
              All entity types are exposed as OData resources at their
              corresponding endpoint:
            </p>
            <div class="code-block">
              https://api.sourceredb.com/odata/{EntityType}
            </div>
            <p>
              These endpoints support OData query options as defined in the RESO
              Web API specification. Here is a brief overview of the available
              query options:
            </p>
            <ul>
              <li>
                <code>$expand</code> - Expand related entities from another
                resource
              </li>
              <li>
                <code>$filter</code> - Filter records based on field values
              </li>
              <li>
                <code>$orderby</code> - Sort results by field values, ascending
                or descending
              </li>
              <li>
                <code>$top</code> - Limit results to a specific number of
                records
              </li>
              <li>
                <code>$skip</code> - Skip a specific number of records in the
                resulting set
              </li>
              <li><code>$count</code> - Include count of resulting records</li>
              <li>
                <code>$select</code> - Select specific fields to include in the
                response
              </li>
            </ul>
            <p>
              For example, here is a query to the Property resource which makes
              use of each query option:
            </p>
            <div class="code-block">
              GET
              https://api.sourceredb.com/odata/Property?$expand=ListAgent&$filter=PropertyType
              eq 'Residential'&$orderby=APIModificationTimestamp
              desc&$top=100&$skip=100&$count=true&$select=APIModificationTimestamp,PropertyType
            </div>
            <p>
              This query will return 100 residential properties, sorting by the
              APIModificationTimestamp field in descending order and skipping
              the first 100 properties. The response will include an
              <code>@odata.count</code> of resulting records, and each record
              will include the <code>APIModificationTimestamp</code> and
              <code>PropertyType</code> fields, as well as the
              <code>ListAgent</code> navigation property.
            </p>

            <h3>Sub-Resources</h3>
            <p>
              Certain entity types are scoped to a single parent resource, and
              are exposed as top-level resources with a prefix of the parent, in
              addition to being available as navigation properties. For example,
              individual rooms associated with a property are exposed as the
              <code>PropertyRooms</code> resource, in addition to being
              available as the <code>Rooms</code> navigation on the
              <code>Property</code> resource:
            </p>
            <div class="code-block">
              GET https://api.sourceredb.com/odata/Property?$expand=Rooms
            </div>

            <!-- <h2>Plans-Based Permissions</h2>
          <p>
            Each record includes a <code>PermittedUse</code> array field listing
            which usages are permitted for that record. This lets clients
            determine the context in which a record can be displayed or
            processed. For example, a record with a
            <code>PermittedUse</code> array of <code>["Public"]</code>.
          </p>
          <p>Other usage-related fields may include:</p>
          <ul>
            <li>Fields prefixed with <code>IDX</code> or <code>VOW</code></li>
            <li>
              <code>SyndicateTo</code> – Enumerated field indicating syndication
              channels
            </li>
          </ul> -->

            <h2 id="webapi-field-record-restrictions">
              Field & Record-Level Restrictions
            </h2>
            <p>
              Permissions are defined per Plan by the MLS and enforced
              automatically. This may include:
            </p>
            <ul>
              <li>Which fields are included</li>
              <li>Which records are visible</li>
            </ul>
            <p>
              The MLS may also define display and usage restrictions for
              specific fields and entities. Clients must consult the MLS for
              display and usage guidelines.
            </p>

            <h2 id="webapi-pagination-filtering">Pagination & Filtering</h2>
            <h3>Pagination</h3>
            <p>
              All endpoints support pagination via
              <code>@odata.nextLink</code>. This is a URL returned in the
              response that can be used to retrieve the next page of results. If
              any query options are passed, such as <code>$top</code> or
              <code>$filter</code>, they will be accounted for in the nextLink
              URL.
            </p>
            <p>
              If no $top value is passed, the default page size will be 10
              records. The maximum value for $top is 1000, unless only the
              primary key of the resource is selected, in which case the maximum
              value is 100,000. For example:
            </p>
            <div class="code-block">
              https://api.sourceredb.com/odata/Property?$select=ListingKey&$top=100000
            </div>

            <h3>Filtering</h3>
            <p>
              OData filters are supported on all fields. The operators available
              may differ based on the field type. Here are some examples:
            </p>
            <div class="code-block">
              https://api.sourceredb.com/odata/Property?$filter=Appliances eq
              'Refrigerator'
            </div>
            <p>With bounds:</p>
            <div class="code-block">
              https://api.sourceredb.com/odata/Property?$filter=BathroomsTotalInteger
              gt 0 and BathroomsTotalInteger lt 3
            </div>

            <h2 id="webapi-updated-records">Updated Records</h2>
            <p>
              The ModificationTimestamp indicates the time in UTC at which the
              record was last updated in the MLS source system. The
              APIModificationTimestamp indicates the time in UTC at which the
              record was last updated in SourceRE.
            </p>
            <div class="code-block">
              { "ModificationTimestamp": "2025-04-01T12:34:56Z",
              "APIModificationTimestamp": "2025-04-01T12:39:49Z" }
            </div>

            <h2 id="webapi-deleted-records">Deleted Records</h2>
            <p>Deleted records appear for 10 days after deletion with:</p>
            <div class="code-block">
              { "DeletedInSource": true, "DeletionTimestamp":
              "2025-04-01T12:34:56Z" }
            </div>
            <p>
              Updates to the DeletionTimestamp will also coincide with updates
              to the APIModificationTimestamp field. If a client stops pulling
              records for 10 days or longer, they must reconcile deletions for a
              resource using the following process:
            </p>
            <ul>
              <li>Pull all primary keys for the resource</li>
              <li>Compare against the primary keys in their local system</li>
              <li>
                Purge records from their local system whose keys are no longer
                found in SourceRE
              </li>
            </ul>

            <h2 id="webapi-replication">Replication</h2>
            <h3>Initial Bulk Load</h3>
            <p>
              Clients must replicate feed data locally. SourceRE recommends the
              following strategy for each parent resource you wish to replicate:
            </p>
            <ul>
              <li>
                Request data using the resource endpoint, including any $filter
                and $select options you wish to use, as well as $expand for any
                sub-resources you wish to replicate (e.g. $expand=Rooms).
              </li>
              <li>
                Follow <code>@odata.nextLink</code> until it no longer appears
                in the response.
              </li>
              <li>If interrupted, restart replication from the beginning.</li>
              <!-- <li>
            If interrupted, resume using:
            <code
              >$filter=APIModificationTimestamp gt
              &lt;last_successful_timestamp&gt;</code
            >
          </li> -->
            </ul>

            <h3>Ongoing Updates</h3>
            <p>
              After replicating the entire dataset as required, poll for
              new/updated records using
              <code>APIModificationTimestamp</code> filters. Start with the
              newest APIModificationTimestamp value you have in your local
              system, and continue pulling until you have caught up to the
              current APIModificationTimestamp value in SourceRE. We recommend a
              filter window of no larger than 1 hour. For example:
            </p>
            <div class="code-block">
              $filter=APIModificationTimestamp gt 2025-05-07T00:00:00Z and
              APIModificationTimestamp lt 2025-05-07T01:00:00Z
            </div>
            <p>
              Pull metadata and lookup updates no more than once per day. We
              recommend refreshing other data at least once per hour. Within
              SourceRE, data updates will occur in 10-minute intervals.
            </p>

            <h3>Media</h3>
            <p>
              The <code>Media</code> resource contains a MediaURL pointing to
              hosted images and documents. Media can be replicated as a top
              level resource and as a navigation property on several resources,
              including: Property, Office, Member, Team, and OpenHouse.
            </p>
            <p>
              <strong>Important:</strong> For photos and documents, do not
              hotlink MediaURLs in production. Always replicate these media
              types to your own servers.
            </p>

            <h2>Rate Limits</h2>
            <p>
              Unless otherwise noted, the following rate limits apply
              <em>per Feed</em>:
            </p>
            <ul>
              <li>No concurrent requests</li>
              <li>Max 3 requests per second</li>
              <li>Max 5,000 requests per hour</li>
            </ul>
            <!-- a more standard backoff strategy? -->
            <p>Violations result in HTTP <code>429</code> responses.</p>

            <h2>Postman Library</h2>
            <p>
              A Postman library is available at this link:
              <a
                href="https://documenter.getpostman.com/view/21580732/2sB3B8qsiw#8f584668-163c-464f-81e8-86a1555a3962"
                target="_blank"
                >SourceRE Postman Library</a
              >
            </p>
            <p>
              It contains examples of how to retrieve metadata, lookup values,
              and data from the SourceRE RESO Web API.
            </p>
            <div style="height: 100px"></div>
            <p>
              For questions pertaining to the API, contact: <strong>support@sourceredb.com</strong>. For any other inquiries, please reach out to the MLS.
            </p>
            <div style="height: 650px"></div>
          </div>
        </main>
      </div>
    </div>

    <div id="addedit" class="tab-content">
      <aside
        id="section-nav-addedit"
        class="section-nav"
        style="
          position: fixed;
          top: 50px;
          left: 0;
          width: 200px;
          padding: 1rem;
          background: #f9f9f9;
          border-right: 1px solid #ddd;
          height: calc(100% - 60px);
          overflow-y: auto;
        "
      >
        <nav>
          <ul
            id="section-list-addedit"
            style="list-style: none; padding: 0; margin: 0"
          >
            <!-- dynamically populated -->
          </ul>
        </nav>
      </aside>
      <div style="margin-left: 240px">
        <main class="addedit-main">
          <div>
            <h1>Add/Edit API (RESO Web API Compliant)</h1>

            <h2 id="addedit-overview">Overview</h2>
            <p>
              SourceRE supports RESO Web API Add/Edit functionality, enabling
              authorized partners to create, update, and delete data in
              participating MLSs. This capability is available only to vendors
              explicitly approved by each MLS.
            </p>
            <p>
              All Add/Edit operations follow the RESO Add/Edit specification,
              with extension to support media streaming uploads as outlined in
              the OData stream property spec, aligning with RESO’s own
              In-Progress specification for Add/Edit with Media.
            </p>

            <h2 id="addedit-authentication">Authentication</h2>
            <p>
              SourceRE uses OAuth 2.0 Client Credentials for Add/Edit access.
            </p>
            <p>
              Before setting up an integration, Add/Edit Partners will log into
              the SourceRE Vendor portal and access the Add/Edit Feeds. Here
              they will see their unique client Id and client secret, as well as
              a list of MLSs who have approved them as an Add/Edit partner, and
              the available scopes for each MLS. The scopes are strings in the
              format
              <code>{MLS Identifier}:{Resource Name}</code> which relate to
              entity types for a given MLS. The Vendor will use the provided
              credentials and scopes to generate JWTs which can be used as
              Bearer tokens in Add/Edit requests to the SourceRE API. The Vendor
              is encouraged to request only the scopes necessary within the
              context of a given area of their system. The Vendor may have
              multiple tokens active at once. Each token may only contain scopes
              for one MLS.
            </p>

            <h3>Token Endpoint</h3>
            <div class="code-block">POST https://api.sourceredb.com/token</div>
            <p>
              <strong>Headers:</strong><br />
              <div class="code-block">Content-Type: application/x-www-form-urlencoded</div>
            </p>
            <p><strong>Body Example:</strong></p>
            <div class="code-block">
              client_id=your_client_id<br />
              client_secret=your_client_secret<br />
              grant_type=client_credentials<br />
              scope=hivemls:property hivemls:media
            </div>
            <p>
              <strong>Note:</strong> All scopes per a given request must be for
              the same MLS.
            </p>

            <h3>Refreshing Tokens</h3>
            <p>Tokens are valid for 8 hours. Refresh them using:</p>
            <div class="code-block">
              POST https://api.sourceredb.com/refresh
            </div>
            <p>Include your refresh token in the request body.</p>

            <h2 id="addedit-permissions-scopes">Permissions & Scopes</h2>
            <p>
              Each MLS assigns Add/Edit scopes per resource (e.g.
              <code>hivemls:property</code>). Vendors may only perform Add/Edit
              operations for resources and fields explicitly permitted by the
              MLS.
            </p>
            <ul>
              <li>Permissions are record- and field-specific</li>
              <li>Vendors may be able to read a record but not modify it</li>
              <li>
                Unauthorized write attempts result in <code>403 Forbidden</code>
              </li>
            </ul>

            <h2 id="addedit-performing-addedit-operations">
              Performing Add/Edit Operations
            </h2>
            <p>
              You may <code>POST</code>, <code>PATCH</code>, or
              <code>DELETE</code> to standard OData endpoints:
            </p>
            <div class="code-block">
              https://api.sourceredb.com/OData/{EntityType}
            </div>

            <h3>Headers</h3>
            <table border="1" cellpadding="6">
              <tr>
                <th>Header</th>
                <th>Description</th>
              </tr>
              <tr>
                <td>Authorization</td>
                <td><code>Bearer &lt;access_token&gt;</code></td>
              </tr>
              <tr>
                <td>If-Match</td>
                <td>
                  Required for updates and deletes, using the resource’s
                  <code>@odata.etag</code>
                </td>
              </tr>
              <tr>
                <td>Prefer</td>
                <td>
                  Use <code>return=representation</code> to return the updated
                  entity<br />
                  Use <code>odata.metadata=full</code> to include annotations
                  (recommended)
                </td>
              </tr>
              <tr>
                <td>Content-Type</td>
                <td><code>application/json</code> for entity bodies</td>
              </tr>
            </table>

            <h3>Example: POST a New Property</h3>
            <div class="code-block">POST https://api.sourceredb.com/OData/Property</div>

            <div class="code-block">
              Request Body:
              {
                "StandardStatus": "Active",
  "ListPrice": 350000,
  "StreetAddress": "123 Main St",
  "City": "Jamestown",
  "StateOrProvince": "CO",
  "PostalCode": "88499"
}
            </div>

            <p><strong>Headers:</strong></p>
            <div class="code-block">
              Authorization: Bearer &lt;token&gt;<br />
              Content-Type: application/json<br />
              Prefer: return=representation, odata.metadata=full
            </div>

            <h3>Response:</h3>
            <div class="code-block">
              {
  "@odata.etag": "W/\"YmluYXJ5J0FBQUFBQUFCaHlwPSc=\"",
  "ListingKey": "000000000000000045994159414168114",
  ...
}
            </div>
            <p>
              Save the <code>@odata.etag</code> of each response, it must be
              passed as part of the <code>If-Match</code> header for updates.
            </p>

            <h3>Example: PATCH an Existing Property</h3>
            <div class="code-block">
              PATCH https://api.sourceredb.com/OData/Property('000000000000000045994159414168114')
Headers:
If-Match: W/"YmluYXJ5J0FBQUFBQUFCaHlwPSc="
Authorization: Bearer &lt;token&gt;
Prefer: return=representation
Content-Type: application/json

Request Body:
{
  "ListPrice": 345000
}
            </div>

            <h2 id="addedit-rate-limits">Rate Limits</h2>
            <p>
              SourceRE’s standard Feed-based rate limits apply for all requests
              to the Add/Edit API, and further constraints are in place for
              write (<code>POST</code>, <code>PATCH</code>, and
              <code>DELETE</code>) requests, which also apply per Feed:
            </p>
            <ul>
              <li>No concurrent requests</li>
              <li>Maximum 1 write request per second</li>
              <li>Max 1,000 write requests per hour</li>
              <li>Max 10 GB uploaded per 24-hour period</li>
            </ul>
            <p>
              Violations result in HTTP <code>429</code> responses. Clients must
              respect back-off strategies and avoid retry storms.
            </p>

            <h2 id="addedit-error-handling">Error Handling</h2>
            <table border="1" cellpadding="6">
              <tr>
                <th>Status Code</th>
                <th>Meaning</th>
              </tr>
              <tr>
                <td>400</td>
                <td>
                  Valid request, but validation failed (e.g., wrong enum,
                  missing required field)
                </td>
              </tr>
              <tr>
                <td>403</td>
                <td>Attempted to modify unauthorized resource or field</td>
              </tr>
              <tr>
                <td>404</td>
                <td>Entity not found or not in vendor scope</td>
              </tr>
              <tr>
                <td>409</td>
                <td>ETag mismatch or concurrent modification</td>
              </tr>
              <tr>
                <td>500</td>
                <td>Internal error, retry later</td>
              </tr>
            </table>

            <h2 id="addedit-media-uploads">
              Media Uploads (OData Stream Properties)
            </h2>

            <h3>Overview</h3>
            <p>Uploading media (photos or documents) involves two steps:</p>
            <ol>
              <li>Create a Media record (with metadata)</li>
              <li>Upload the binary data stream using the mediaEditLink</li>
            </ol>

            <h3>Supported MediaType Values</h3>
            <table border="1" cellpadding="6">
              <tr>
                <th>MediaType</th>
                <th>Description</th>
                <th>Allowed Content-Types</th>
              </tr>
              <tr>
                <td>Photo</td>
                <td>Images</td>
                <td>image/png, image/jpeg</td>
              </tr>
              <tr>
                <td>Document</td>
                <td>PDFs</td>
                <td>application/pdf</td>
              </tr>
            </table>
            <p>
              <strong>Note:</strong> MLSs may restrict allowed types per vendor.
            </p>

            <h3>Step 1: Create Media Record</h3>
            <div class="code-block">POST https://api.sourceredb.com/OData/Media

Request Body:
{
  "MediaType": "Photo",
  "ResourceName": "Member",
  "ResourceRecordKey": "000000000000000045994159414168114",
}
            </div>

            <h3>Response:</h3>
            <div class="code-block">
              {
  "@odata.id": "https://api.sourceredb.com/OData/Media('9755bb5d-132a-484f-b761-754e126e8fba')",
  "@odata.editLink": "Media('9755bb5d-132a-484f-b761-754e126e8fba')",
  "@odata.mediaEditLink": "Media('9755bb5d-132a-484f-b761-754e126e8fba')/$value",
  "@odata.etag": "W/\"YmluYXJ5J0FBQUFBQUFCam5NPSc=\"",
  "MediaStatus": "Incomplete",
  "MediaKey": "9755bb5d-132a-484f-b761-754e126e8fba"
}
            </div>
            <p>
              <strong>Note:</strong> While waiting for the content to be posted,
              the Media record will be of MediaStatus “Incomplete”. Only records
              with a MediaStatus of “Complete” will be shown in any MLS Feeds
              aside from the current Add/Edit Feed.
            </p>

            <h3>Step 2: Upload Media Content</h3>
            <div class="code-block">POST https://api.sourceredb.com/OData/Media('9755bb5d-132a-484f-b761-754e126e8fba')/$value
Headers:
Authorization: Bearer &lt;token&gt;
Content-Type: image/png

Body: Raw binary stream (e.g., PNG or JPEG)
            </div>
            <p><strong>Response:</strong> 200 OK</p>
            <p>
              After a successful content upload, the MediaStatus will transition
              to “Processing” and then to “Complete”. Records which are complete
              may have their content updated using the
              <code>mediaEditLink</code>, which will cause them to transition to
              “Processing” again. If the content cannot be processed, the
              MediaStatus will transition to “Rejected” and a
              <code>MediaStatusDescription</code> field will be applied to the
              record listing the reason for rejection. The record will then have
              the <code>DeletedInSource</code> flag applied.
            </p>

            <h2 id="addedit-validation-notes">Validation Notes</h2>
            <ul>
              <li>
                You must POST media within one hour after creating the Media
                record, otherwise the MediaStatus will transition to “Rejected”
                and the Media record will be deleted (first through application
                of the
                <code>DeletedInSource</code> flag, then through removal).
              </li>
              <li>
                SourceRE places a <strong>1MB size limit</strong> on uploaded
                files. If a Vendor needs to upload larger images or documents
                and cannot fit the requirement using image compression, they
                should reach out to SourceRE’s API support team.
              </li>
              <li>
                MLSs may enforce:
                <ul>
                  <li>MediaType and Content Type restrictions</li>
                  <li>Total media count limit per record</li>
                </ul>
              </li>
            </ul>

            <h2 id="addedit-best-practices">Requirements</h2>
            <ul>
              <li>
                Always use the latest <code>@odata.etag</code> in the
                <code>If-Match</code> header when updating records. It is not
                applicable for Media uploads.
              </li>
              <li>
                Use <code>Accept: application/json; odata.metadata=full</code> to retrieve full OData metadata in responses.
              </li>
              <li>
                Contact the MLS if receiving <code>403</code> errors —
                permissions are MLS-controlled
              </li>
            </ul>

            <h2 id="addedit-questions">Questions?</h2>
            
            <p><strong>support@sourceredb.com</strong></p>
                        <div style="height: 650px"></div>

          </div>
        </main>
      </div>
    </div>

    <script>
      const tabs = document.querySelectorAll("nav span");
      const contents = document.querySelectorAll(".tab-content");

      tabs.forEach((tab) => {
        tab.addEventListener("click", () => {
          tabs.forEach((t) => t.classList.remove("active"));
          contents.forEach((c) => c.classList.remove("active"));

          tab.classList.add("active");
          const activeTabId = tab.dataset.tab;
          document.getElementById(activeTabId).classList.add("active");

          if (activeTabId === "webapi") {
            const overview = document.querySelector("#webapi h2");
            if (overview) {
              overview.scrollIntoView({ behavior: "smooth", block: "start" });
            }
          } else if (activeTabId === "addedit") {
            const overview = document.querySelector("#addedit h2");
            if (overview) {
              overview.scrollIntoView({ behavior: "smooth", block: "start" });
            }
          }
        });
      });

      // extract this into a function and call it for each tab
      document.addEventListener("DOMContentLoaded", () => {
        const webApiHeadings = document.querySelectorAll(".webapi-main h2");
        const webApiNavList = document.getElementById("section-list-webapi");
        const addEditHeadings = document.querySelectorAll(".addedit-main h2");
        const addEditNavList = document.getElementById("section-list-addedit");

        webApiHeadings.forEach((heading, index) => {
          let id = heading.id;
          console.log(id);
          if (!id) {
            id = `webapi-section-${index}`;
            heading.id = id;
          }

          const li = document.createElement("li");
          const link = document.createElement("a");
          link.href = `#${id}`;
          link.textContent = heading.textContent;
          li.appendChild(link);
          webApiNavList.appendChild(li);
        });

        addEditHeadings.forEach((heading, index) => {
          let id = heading.id;
          console.log(id);
          if (!id) {
            id = `addedit-section-${index}`;
            heading.id = id;
          }

          const li = document.createElement("li");
          const link = document.createElement("a");
          link.href = `#${id}`;
          link.textContent = heading.textContent;
          li.appendChild(link);
          addEditNavList.appendChild(li);
        });

        const webApiNavLinks = document.querySelectorAll(
          "#section-list-webapi a"
        );
        const addEditNavLinks = document.querySelectorAll(
          "#section-list-addedit a"
        );

        function highlightNav() {
          if (document.getElementById("webapi").classList.contains("active")) {
            let scrollPos =
              document.documentElement.scrollTop || document.body.scrollTop;
            let currentId = "";

            webApiHeadings.forEach((h2) => {
              const offset = h2.offsetTop - 70; // adjust for header height
              if (scrollPos >= offset) {
                currentId = h2.id;
              }
            });

            webApiNavLinks.forEach((link) => {
              link.classList.toggle(
                "active",
                link.getAttribute("href") === `#${currentId}`
              );
            });
          } else if (
            document.getElementById("addedit").classList.contains("active")
          ) {
            let scrollPos =
              document.documentElement.scrollTop || document.body.scrollTop;
            let currentId = "";

            addEditHeadings.forEach((h2) => {
              const offset = h2.offsetTop - 70; // adjust for header height
              if (scrollPos >= offset) {
                currentId = h2.id;
              }
            });

            addEditNavLinks.forEach((link) => {
              link.classList.toggle(
                "active",
                link.getAttribute("href") === `#${currentId}`
              );
            });
          }
        }

        window.addEventListener("scroll", highlightNav);
      });
    </script>
  </body>
</html>
